---
title: "Markdown Template"
output:
  html_document:
    df_print: paged
    theme: cerulean
    highlight: haddock
    toc: yes
    toc_float: yes
    code_folding: show
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=F, warning=F, fig.width = 10)
```


# Load Packages

```{r}

library( haven )
library( tidyr )
library( dplyr )
library( ggplot2 )
library( ggthemes )
library( scales )
library( stargazer )
library( pander )

```

## Custom Functions

```{r}

jplot <- function( x1, x2, lab1="", lab2="", draw.line=T, ... )
{

	plot( x1, x2,
	      pch=19, 
	      col=gray(0.6, alpha = 0.5), 
	      cex=1.5,  
	      bty = "n",
	      xlab=lab1, 
	      ylab=lab2, cex.lab=1.5,
        ... )

	if( draw.line==T ){ 
		ok <- is.finite(x1) & is.finite(x2)
		lines( lowess(x2[ok]~x1[ok]), col="red", lwd=3 ) }

}

```



# Density

## Definitions

Nonprofit density is the measure of the growth and competition in a market. The growth and competition might influence the performance, survival of nonprofits in the market. There are two competing forces generated by density: legitimacy that attracts financial support for nonprofits and competition that creates entry barrier for new organizations (Hannan & Freeman, 1987) 

## Calculations

Nonprofit density be calculated as follows: 

Approach 1:

The number of nonprofits in a market (Harrison & Thornton, 2014; Saxton & Benson, 2005; LeRoux & Wright, 2010; Lecy & Van Slyke, 2013; Castaneda, Garen, & Thornton, 2007 ). 

Approach 2:

The number of nonprofits per capita in a market (Harrison & Thornton, 2014; Paarlberg & Hwang, 2017). This is also called demand density (Harrison & Thornton, 2014).
¡E	measured as the number of organizations per 10,000 population (Paarlberg & Hwang, 2017)
¡E	measured as the number of organizations per 1,000 population (Paarlberg, An, Nesbit, Christensen, & Bullock, 2018)

 
## Notes

We define a market as a Metropolitan Statistical Area (MSA) in which relevant nonprofits compete for resources to survive. 




# Create Metrics

```{r, eval=F}

setwd( "C:/Users/JK/Desktop/R Practice " )
core.2000 <- readRDS( "nccs.core2010pc.rds" )
names( core.2000 ) <- toupper( names( core.2000 ))
core <- select( core.2000, EIN, MSA_NECH, NTMAJ12, FIPS)
num.npos.2000.MSA <- tapply( core$EIN, core$ MSA_NECH, length )
num.npos.2000 <- tapply( core$EIN, INDEX=list(core$ MSA_NECH,core$NTMAJ12), length )


msa.popu <- read.csv( "MSA.Population.2010.csv", stringsAsFactors=F )
core$FIPS <- as.integer( core$FIPS )
core <- merge( core, msa.popu, by.x="FIPS", by.y="FIPS", all.x=T )


head( ) %>% pander()

```



## Descriptive Statistics


## Reference

Hannan, M. T., & Freeman, J. (1987). The ecology of organizational founding: American labor unions, 1836-1985. American Journal of Sociology, 92(4), 910-943.

Harrison, T., & Thornton, J. (2014, October). Too many nonprofits? An empirical approach to estimating trends in nonprofit demand density. In Nonprofit Policy Forum (Vol. 5, No. 2, pp. 213-229). De Gruyter.

Saxton, G. D., & Benson, M. A. (2005). Social capital and the growth of the nonprofit sector. Social Science Quarterly, 86(1), 16-35.

Paarlberg, L. E., An, S. H., Nesbit, R., Christensen, R. K., & Bullock, J. (2018). A Field Too Crowded? How Measures of Market Structure Shape Nonprofit Fiscal Health. Nonprofit and Voluntary Sector Quarterly, 47(3), 453-473.

LeRoux, K., & Wright, N. S. (2010). Does performance measurement improve strategic decision making? Findings from a national survey of nonprofit social service agencies. Nonprofit and Voluntary Sector Quarterly, 39(4), 571-587.
Lecy, J. D., & Van Slyke, D. M. (2013). Nonprofit sector growth and density: Testing theories of government support. Journal of Public Administration Research and Theory, 23, 189-214.

Castaneda, M. A., Garen, J., & Thornton, J. (2007). Competition, contractibility, and the market for donors to nonprofits. The Journal of Law, Economics, & Organization, 24(1), 215-246.







```{css, echo=F}
p {
color: black;
margin: 0 0 20px 0;
}

td {
    padding: 3px 10px 3px 10px;
    text-align: center;
}

table
{ 
    margin-left: auto;
    margin-right: auto;
    margin-top:80px;
    margin-bottom:100px;
}

h1, h2{
  margin-top:100px;
  margin-bottom:20px;
}

H5{
    text-align: center;
    color: gray;
    font-size:0.8em;
}

img {
    max-width: 90%;
    display: block;
    margin-right: auto;
    margin-left: auto;
    margin-top:30px;
    margin-bottom:20px;
}

pre {
  overflow-x: auto;
}

pre code {
   display: block; 
   padding: 0.5em;
   margin-bottom:20px;
}

code {
  font-size: 92%;
  border: 10px solid #F8F8F8;
  margin-bottom: 2px;
}

code[class] {
  background-color: #F8F8F8;
}

```

